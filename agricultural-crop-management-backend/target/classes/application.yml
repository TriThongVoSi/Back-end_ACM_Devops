# =========================================================
# Common Configuration (shared by all profiles)
# =========================================================
spring:
  application:
    name: QuanLyMuaVu
  config:
    import: optional:file:.env[.properties],optional:file:agricultural-crop-management-backend/.env[.properties]

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  # Database Configuration
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/quanlymuavu}
    username: ${DB_USER:}
    password: ${DB_PASS:}
    driver-class-name: com.mysql.cj.jdbc.Driver

  # JPA Configuration (common settings)
  jpa:
    open-in-view: false
    properties:
      hibernate:
        connection:
          characterEncoding: utf-8
          CharSet: utf-8
          useUnicode: true
  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 5MB

  # Mail Configuration (common timeouts)
  mail:
    properties:
      mail:
        smtp:
          connectiontimeout: ${SMTP_CONNECTION_TIMEOUT:5000}
          timeout: ${SMTP_TIMEOUT:5000}
          writetimeout: ${SMTP_WRITE_TIMEOUT:5000}

# Server Configuration
server:
  port: ${SERVER_PORT:${PORT:8080}}
  servlet:
    context-path: /

# Swagger/OpenAPI Configuration
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: method
    tags-sorter: alpha
    try-it-out-enabled: true
    filter: true
    deep-linking: true
    display-operation-id: true
    display-request-duration: true
    persist-authorization: true

# JWT Configuration
jwt:
  signerKey: ${JWT_SIGNER_KEY}
  valid-duration: ${JWT_VALID_DURATION:3600}
  refreshable-duration: ${JWT_REFRESHABLE_DURATION:36000}

# App Configuration
app:
  url: ${APP_URL:http://localhost:5173}
  mail:
    from: ${MAIL_FROM:no-reply@acm.local}
  password-reset:
    expiry-minutes: ${PASSWORD_RESET_EXPIRY_MINUTES:15}
    rate-limit:
      max: ${PASSWORD_RESET_RATE_LIMIT_MAX:3}
      window-minutes: ${PASSWORD_RESET_RATE_LIMIT_WINDOW_MINUTES:15}
  ai:
    base-url: ${APP_AI_BASE_URL:https://generativelanguage.googleapis.com}
    api-key: ${APP_AI_API_KEY:}
    model: ${APP_AI_MODEL:gemini-2.5-flash}
  expense:
    attachments:
      dir: ${EXPENSE_ATTACHMENTS_DIR:uploads/expenses}

# Farm Security
farm:
  security:
    trust-proxy-headers: false
    trusted-proxy-ips: []

# Logging Configuration (default - can be overridden by profiles)
logging:
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
